---
import SectionTitle from "@/components/ui/SectionTitle.astro";
import PostCard from "@/components/blog/PostCard.astro";
import { getCollection } from "astro:content";

const latestPosts = (await getCollection("blog", ({ data }) => !data.draft))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 3);
---

{
  latestPosts.length > 0 && (
    <section class="section-padding bg-bg-secondary">
      <div class="container-custom">
        <div class="flex items-end justify-between mb-12">
          <SectionTitle label="BLOG" title="Últimos Artículos" />
          <a
            href="/blog"
            class="hidden sm:inline-flex items-center gap-2 text-accent-primary hover:underline font-medium"
          >
            Ver todos
            <svg
              class="w-4 h-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17 8l4 4m0 0l-4 4m4-4H3"
              />
            </svg>
          </a>
        </div>

        <div class="grid md:grid-cols-3 gap-8">
          {latestPosts.map((post) => (
            <PostCard post={post} />
          ))}
        </div>
      </div>
    </section>
  )
}
